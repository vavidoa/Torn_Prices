<!DOCTYPE html>
<html>
<head>
<title>Get Data from Google Sheet</title>
<script>
  function fetchData() {
    const publishedUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS3LPzNK6lLHuYpzyBO-534D5Gx696_kWpnfCCzu6qPat633qJLsswmADacn_v2dl26CSIJzLdLTv3n/pubhtml';
    const gid = '2110901138';

    // Construct the Google Sheets API URL for JSON output
    const url = `https://docs.google.com/spreadsheets/d/e/2PACX-1vS3LPzNK6lLHuYpzyBO-534D5Gx696_kWpnfCCzu6qPat633qJLsswmADacn_v2dl26CSIJzLdLTv3n/pub?gid=${gid}&single=true&output=csv`;

    fetch(url)
      .then(response => response.text())
      .then(data => {
        displayDataAsTable(data);
      })
      .catch(error => {
        document.getElementById('dataContainer').innerText = 'Error fetching data: ' + error;
      });
  }

  function displayDataAsTable(csvData) {
    const dataContainer = document.getElementById('dataContainer');
    dataContainer.innerHTML = ''; // Clear previous data

    const lines = csvData.trim().split('\n');
    if (lines.length === 0) {
      dataContainer.innerText = 'No data found.';
      return;
    }

    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const tbody = document.createElement('tbody');

    // Create table header
    const headerRow = document.createElement('tr');
    const headers = lines[0].split(',');
    headers.forEach(headerText => {
      const th = document.createElement('th');
      th.textContent = headerText.trim();
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Create table body rows
    for (let i = 1; i < lines.length; i++) {
      const dataRow = document.createElement('tr');
      const cells = lines[i].split(',');
      cells.forEach(cellText => {
        const td = document.createElement('td');
        td.textContent = cellText.trim();
        dataRow.appendChild(td);
      });
      tbody.appendChild(dataRow);
    }

    table.appendChild(tbody);
    dataContainer.appendChild(table);
  }

  window.onload = fetchData;
</script>
<style>
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 20px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #f2f2f2;
  }
</style>
</head>
<body>

  <h1>Data from Google Sheet</h1>

  <div id="dataContainer">
    Loading data...
  </div>

</body>
</html>
